{"version":3,"sources":["app.js","controllers/appCtrl.js","controllers/controllers.js","directives/directives.js","filters/filters.js","services/services.js"],"names":["app","angular","module","constant","config","FacebookProvider","$httpProvider","RestangularProvider","apiBase","setAppId","setBaseUrl","interceptors","push","$q","$location","$localStorage","$rootScope","Auth","request","headers","token","Authorization","response","t","replace","responseError","status","data","error","resetProfile","path","console","log","reject","run","$mdThemingProvider","myPaletteMap","extendPalette","contrastDefaultColor","contrastDarkColors","contrastLightColors","500","50","100","200","300","400","600","700","definePalette","theme","primaryPalette","default","hue-1","hue-2","hue-3","accentPalette","warnPalette","backgroundPalette","dark","$stateProvider","$urlRouterProvider","$locationProvider","appBase","state","abstract","templateUrl","url","controller","showSideNav","template","resolve","profile","$stateParams","Restangular","one","hash_id","get","views","","@web.app.dashboard.user","@web.app.dashboard","otherwise","html5Mode","enabled","requireBase","$scope","$mdSidenav","$mdMedia","$state","AppService","Me","location","user","userProfile","composingPost","tokHashId","ui","showSearch","toggleNav","which","toggle","toggleSearchBox","getCategories","then","cats","categories","originatorEv","openMenu","$mdOpenMenu","ev","logout","redirect","go","menu","link","title","icon","condition","click","menuAuth","action","getSearchResultIcon","type","searchIcons","tag","searchRepo","query","d","defer","search","getList","q","plain","promise","UXService","$document","post_status","loading","loadPosts","load","param","getPosts","r","posts","err","toast","cat","category","Facebook","authenticated","fb_button","getLoginStatus","api","fb_logged_in","fb_name","name","loginFB","signinFB","UXLoginFB","UXSubmitLogin","loginDetails","submitLogin","signin","$mdDialog","refresh","newUser","signupFb","login","fields","show","alert","parent","element","document","querySelector","clickOutsideToClose","ariaLabel","ok","submitForm","signupForm","$valid","signup","user_profile","activities","favorites","taps","loadUserProfile","loadUserPosts","all","loadUserFavorites","loadUserTaps","Upload","uploadAvatar","file","uploading","upload","dataUrltoBlob","avatar","picFile","dataUrl","$timeout","result","errorMsg","evt","progress","parseInt","loaded","total","$mdToast","selectedCategories","files","newPost","creating","length","i","toggleCatPopup","showSelectCatPopup","catsClick","idx","indexOf","splice","catsExists","removePicture","uploadImages","finished","doUpload","complete","image_id","failed","Math","min","forEach","composePost","post","anonymous","$viewValue","createPost","o","count","id","sendPost","p","a","images","unshift","emojiMessage","rawhtml","id_arr","trim","hide","cancel","answer","res","actives","filePostIn","directive","restrict","transclude","PostService","scope","this","SDeletePost","post_id","remove","map","x","noPosts","CommentService","appUrl","require","attrs","SuperTPostsCtrl","CommentsUI","actions","App\\Tap","App\\Favorite","App\\Amen","App\\Comment","user_ref_activities","interpretation","ref_activities","l","a_t","action_type","showCommentBox","openCommentBox","comments","addComment","doCommentPost","commentBox","text","comments_count","signinModal","v","deleteComment","comment_id","comment","toggleFavorite","doFavorite","favorited","favorites_count","toggleTap","doTap","tapped_into","taps_count","sayAmen","doSayAmen","amen","amens_count","shareToFb","method","picture","caption","description","deletePost","e","filter","num","out","round","factory","refreshProfile","service","$http","urlBase64Decode","str","output","window","atob","getClaimsFromToken","claims","encoded","split","JSON","parse","firstName","lastName","sex","email","setFullResponse","exp","Date","now","buildAuthProfile","u","first_name","last_name","country","saveToken","doFbLogin","fb_response","json","fb_access_token","authResponse","accessToken","tokenClaims","uid","sub","me","getElementsByClassName","targetEvent","simple","content","position","hideDelay"],"mappings":"AAEA,GAAIA,KAAMC,QAAQC,OAAO,WAAY,aACjC,6BACA,YACA,aACA,gBACA,YACA,YACA,cACA,WACA,eACA,YACA,iBACA,YAIJF,KAAIG,SAAS,SAAU,iDACvBH,IAAIG,SAAS,UAAW,KACxBH,IAAIG,SAAS,UAAW,gCAGxBH,IAAII,QAAA,mBAAA,gBAAA,sBAAA,UAAO,SAASC,EAAkBC,EAAeC,EAAqBC,GACtEH,EAAiBI,SAAS,gBAC1BF,EAAoBG,WAAWF,GAE/BF,EAAcK,aAAaC,MAAM,KAAM,YAAa,gBAAiB,SAASC,EAAIC,EAAWC,EAAeC,EAAYC,GACpH,OACIC,QAAW,SAASd,GAKhB,MAJAA,GAAOe,QAAUf,EAAOe,YACpBJ,EAAcK,QACdhB,EAAOe,QAAQE,cAAgB,UAAYN,EAAcK,OAEtDhB,GAEXkB,SAAY,SAASA,GACjB,GAAIC,GAAID,EAASH,QAAQ,gBAOzB,OANII,KACAA,EAAEC,QAAQ,UAAW,IACrBT,EAAcK,MAAQG,GAInBD,GAEXG,cAAiB,SAASH,GAyBtB,OAxBwB,MAApBA,EAASI,QAAsC,MAApBJ,EAASI,QAAsC,MAApBJ,EAASI,UACpC,iBAAvBJ,EAASK,KAAKC,aACPb,GAAcK,MACrBH,EAAKY,eACLf,EAAUgB,KAAK,YACe,iBAAvBR,EAASK,KAAKC,aACdb,GAAcK,MACrBH,EAAKY,eACLf,EAAUgB,KAAK,YACe,qBAAvBR,EAASK,KAAKC,aACdb,GAAcK,MACrBH,EAAKY,eACLf,EAAUgB,KAAK,YACe,sBAAvBR,EAASK,KAAKC,cACdb,GAAcK,MACrBH,EAAKY,eACLf,EAAUgB,KAAK,YAKnBC,QAAQC,IAAI,8BAGTnB,EAAGoB,OAAOX,WAMjCtB,IAAIkC,IAAI,cAgBRlC,IAAII,QAAA,qBAAO,SAAS+B,GAChB,GAAIC,GAAeD,EAAmBE,cAAc,QAEhDC,qBAAwB,QACxBC,mBAAsB,WACtBC,oBAAuB,MACvBC,IAAO,SACPC,GAAM,SACNC,IAAO,SACPC,IAAO,SACPC,IAAO,SACPC,IAAO,SACPC,IAAO,SACPC,IAAO,UAEXb,GAAmBc,cAAc,UAAWb,GAE5CD,EAAmBe,MAAM,WACpBC,eAAe,WACZC,UAAW,MACXC,QAAS,KACTC,QAAS,MACTC,QAAS,QAEZC,cAAc,WACXJ,UAAW,MACXC,QAAS,MACTC,QAAS,QAGZG,YAAY,UAIjBtB,EAAmBe,MAAM,QAAS,WAC7BC,eAAe,WAGfO,kBAAkB,WACfN,UAAW,QACZO,OAEPxB,EAAmBe,MAAM,SAAU,WAC9BC,eAAe,aAGfO,kBAAkB,WACfN,UAAW,OACZO,UAKX3D,IAAII,QAAA,iBAAA,qBAAA,oBAAA,UAAO,SAASwD,EAAgBC,EAAoBC,EAAmBC,GACvEH,EACKI,MAAM,OAEHC,YAAU,EACVC,YAAa,mBACdF,MAAM,WACLC,YAAU,EACVE,IAAKJ,EACLG,YAAa,uBACdF,MAAM,iBACLG,IAAK,QACLD,YAAa,6BACdF,MAAM,kBACLG,IAAK,SACLC,WAAY,YACZF,YAAa,4BACbvC,MACI0C,aAAa,KAElBL,MAAM,kBACLG,IAAK,SAELC,WAAY,aACZE,SAAU,IACV3C,MACI0C,aAAa,KAElBL,MAAM,mBACLG,IAAK,GACLD,YAAa,+BACdF,MAAM,qBACLC,YAAU,EACVE,IAAK,GACLD,YAAa,iCACdF,MAAM,0BACLG,IAAK,OACLD,YAAa,sCACdF,MAAM,0BACLG,IAAK,gBACLD,YAAa,sCACdF,MAAM,2BACLG,IAAK,YACLD,YAAa,sCACdF,MAAM,0BACLG,IAAK,gBACLI,SACIC,SAAA,eAAA,cAAS,SAASC,EAAcC,GAC5B,MAAOA,GAAYC,IAAI,QAASF,EAAaG,SAASC,SAG9DC,OACIC,IACIb,YAAa,uCACbE,WAAY,eAEhBY,2BACId,YAAa,sDAGtBF,MAAM,qCACLG,IAAK,cACLD,YAAa,oDACdF,MAAM,oCACLG,IAAK,aACLD,YAAa,mDACdF,MAAM,+BACLG,IAAK,QACLD,YAAa,8CACdF,MAAM,+BACLG,IAAK,QACLW,OACIG,sBACIf,YAAa,gDAM7BL,EAAmBqB,UAAUnB,EAAU,QAEvCD,EAAkBqB,WACdC,SAAS,EACTC,aAAa;ACrOrBrF,IAAIoE,WAAW,WAAA,aAAA,SAAA,aAAA,WAAA,YAAA,SAAA,KAAA,aAAA,OAAA,KAAA,UAAW,SAASpD,EAAYsE,EAAQC,EAAYC,EAAU1E,EAAW2E,EAAQ5E,EAAI6E,EAAYzE,EAAM0E,EAAI5B,GACtHuB,EAAOM,SAAW9E,EAClBwE,EAAOO,KAAO5E,EAAK6E,YACnBR,EAAOS,eAAgB,EACvBT,EAAOU,UAAY/E,EAAKG,MAAMwD,QAG9BU,EAAOW,IACHC,YAAY,EACZ7B,YAAaoB,EACbU,UAAW,SAASC,GAChBb,EAAWa,GAAOC,UAGtBC,gBAAiB,WACbhB,EAAOW,GAAGC,YAAcZ,EAAOW,GAAGC,aAO1CR,EAAWa,cAAcC,KAAK,SAASC,GAEnCnB,EAAOoB,WAAaD,EAAK9E,MAI7B,IAAIgF,EACJrB,GAAOsB,SAAW,SAASC,EAAaC,GACpCH,EAAeG,EACfD,EAAYC,IAIhBxB,EAAOyB,OAAS,WACZ9F,EAAK8F,UAKTzB,EAAO0B,SAAW,SAAShD,GACvByB,EAAOwB,GAAGjD,IAGdsB,EAAO4B,OACHC,KAAM,GACNnD,MAAO,yBACPoD,MAAO,QACPC,KAAM,OACNC,WAAW,EACXC,MAAO,KAGXjC,EAAOkC,WACHL,KAAM,UACNnD,MAAO,+CACPoD,MAAO,UACPC,KAAM,UACNC,UAAW,qBACXG,OAAQ,OAERN,KAAM,GACNnD,MAAO,yBACPoD,MAAO,WACPC,KAAM,uBACNC,UAAW,qBACXC,MAAO,KAEPJ,KAAM,8BACNnD,MAAO,yDACPoD,MAAO,aACPC,KAAM,OACNC,UAAW,qBACXG,OAAQ,OAERN,KAAM,8BACNnD,MAAO,6BACPoD,MAAO,WACPC,KAAM,WACNC,UAAW,qBACXG,OAAQ,OAOZnC,EAAOoC,oBAAsB,SAASC,GAElC,MAAON,MAAKM,IAGhBrC,EAAOsC,aACHC,IAAO,QACPhC,KAAQ,MAKZP,EAAOwC,WAAa,SAASC,GACzB,GAAIC,GAAInH,EAAGoH,OAWX,OAVAvC,GAAWwC,OAAOC,SACdC,EAAGL,IACJvB,KAAK,SAASlF,GACb0G,EAAEzD,QAAQjD,EAASK,KAAK0G,UAGzB,WACCL,EAAE/F,WAGC+F,EAAEM;AChHjBtI,IAAIoE,WAAW,aAAc,aAAc,KAAM,SAAU,SAAU,eAAgB,cAAe,YAAa,YAAa,SAASsB,EAAYC,EAAIL,EAAQG,EAAQhB,EAAcC,EAAa6D,EAAWC,GACzMlD,EAAOtF,IAAM0F,EAAW1F,IACxBsF,EAAOmD,aACHC,SAAS,EAEb,IAAIC,GAAY,WAaZ,QAASC,GAAKC,GAEVnD,EAAWoD,SAASX,QAAQU,GAAOrC,KAAK,SAASuC,GAE7CrD,EAAW1F,IAAIgJ,MAAQD,EAAEpH,KAMzB2D,EAAOmD,YAAYC,SAAU,GAE9B,SAASO,GACR3D,EAAOmD,YAAYC,SAAU,EAE7BH,EAAUW,MAAM,uBA1BxB5D,EAAOmD,YAAYC,SAAU,EAGzBE,EADAnE,EAAa0E,KAETC,SAAU3E,EAAa0E,SA2BnCR,QAMJ3I,IAAIoE,WAAW,aAAc,SAAU,YAAa,WAAY,KAAM,SAAU,OAAQ,KAAM,UAAW,SAASkB,EAAQiD,EAAWc,EAAUxI,EAAI4E,EAAQxE,EAAM0E,EAAI5B,GAE7J9C,EAAK6E,YAAYwD,iBAAkB,GACnC7D,EAAOwB,GAAG,0BAGd3B,EAAOiE,UAAY,sBAEnBF,EAASG,eAAe,SAAST,GAEZ,cAAbA,EAAErH,OAEF2H,EAASI,IAAI,MAAO,SAASV,GACzBzD,EAAOoE,cAAe,EACtBpE,EAAOqE,QAAUZ,EAAEa,KACnBtE,EAAOiE,UAAY,eAAiBjE,EAAOqE,WAK/CrE,EAAOoE,cAAe,EACtBpE,EAAOqE,QAAU,OACjBrE,EAAOiE,UAAY,yBAI3BjE,EAAOuE,QAAU,WACb5I,EAAK6I,WAAWtD,KAAK,WACjBf,EAAOwB,GAAG,2BACX,SAAS8B,GACRR,EAAUW,MAAMH,EAAEpH,KAAKC,UAI/B0D,EAAOyE,UAAY,WACfxB,EAAUwB,aAGdzE,EAAO0E,cAAgB,WACnBzB,EAAUyB,cAAc1E,EAAO2E,cAiBnC3E,GAAO4E,YAAc,WACjBjJ,EAAKkJ,OAAO7E,EAAO2E,cAAczD,KAAK,SAASuC,GAE3CtD,EAAOwB,GAAG,2BAGX,SAASgC,GACRlH,QAAQC,IAAIiH,SAOxBjJ,IAAIoE,WAAW,cAAe,SAAU,WAAY,OAAQ,YAAa,YAAa,SAAU,SAASkB,EAAQ+D,EAAUpI,EAAMH,EAAWsJ,EAAW3E,GACnJ,GAAI4E,EAEJ/E,GAAOgF,WACPhF,EAAOiF,SAAW,WACdlB,EAASmB,QAAQhE,KAAK,WAClB6D,OAIRA,EAAU,WACNhB,EAASI,IAAI,OACTgB,OAAQ,kCACTjE,KACC,SAASlF,GACL+H,EAAStC,UAOb,SAASkC,GACLmB,EAAUM,KACNN,EAAUO,QACTC,OAAO3K,QAAQ4K,QAAQC,SAASC,cAAc,UAC9CC,qBAAoB,GACpB5D,MAAM,iBAEN6D,UAAU,gBACVC,GAAG,aAQpB5F,EAAO6F,WAAa,WAGZ7F,EAAO8F,WAAWC,QAClBpK,EAAKqK,OAAOhG,EAAOgF,SAAS9D,KACxB,SAASuC,GAELtD,EAAOwB,GAAG,2BAGd,SAAS8B,UAQzB/I,IAAIoE,WAAW,cAAe,SAAU,OAAQ,KAAM,SAASkB,EAAQrE,EAAM0E,GACzE1E,EAAK8F,SAELhF,QAAQC,IAAI,aAGhBhC,IAAIoE,WAAW,eAAgB,cAAe,SAAU,eAAgB,SAAU,SAASM,EAAaY,EAAQb,EAAcgB,GAE1H,GAAI8F,GAAe7G,EAAYC,IAAI,QAASF,EAAaG,QAEzDU,GAAOO,MACHrB,WACAgH,cACAC,aACAC,QAIJ,IAAIC,GAAkB,WAClBJ,EAAa5G,IAAI,WAAWE,MAAM2B,KAAK,SAASuC,GAC5CzD,EAAOO,KAAKrB,QAAUuE,EAAEpH,QAI5BiK,EAAgB,WAChBL,EAAaM,IAAI,cAAc1D,UAAU3B,KAAK,SAASuC,GACnDzD,EAAOO,KAAK2F,WAAazC,EAAEpH,QAI/BmK,EAAoB,WACpBP,EAAaM,IAAI,aAAa1D,UAAU3B,KAAK,SAASuC,GAClDzD,EAAOO,KAAK4F,UAAY1C,EAAEpH,QAI9BoK,EAAe,WACfR,EAAaM,IAAI,QAAQ1D,UAAU3B,KAAK,SAASuC,GAC7CzD,EAAOO,KAAK6F,KAAO3C,EAAEpH,OAI7BgK,KACAC,IACAE,IACAC,OAKJ/L,IAAIoE,WAAW,mBAAoB,cAAe,SAAU,eAAgB,SAAU,SAAU,OAAQ,YAAa,UAAW,SAASM,EAAaY,EAAQb,EAAcgB,EAAQuG,EAAQ/K,EAAMsH,EAAW/H,GAEtLkE,EAAYC,IAAI,QAASF,EAAaG,QAEzDU,GAAOO,KAAO5E,EAAK6E,YAEf7E,EAAK6E,YAAYlB,UAAYH,EAAaG,SAE1Ca,EAAOwB,GAAG,0BAId3B,EAAO2G,aAAe,SAASC,GAC3B5G,EAAO6G,WAAY,EAEnBH,EAAOI,QACHjI,IAAK3D,EAAU,UAAYS,EAAK6E,YAAYlB,QAAU,kBACtDjD,MACIuK,KAAMF,EAAOK,cAAcH,MAIhC1F,KAAK,SAASuC,GACb9H,EAAK6E,YAAYwG,OAASvD,EAAEpH,KAAKwC,IACjCoE,EAAUW,MAAM,8CAEjB,WAECX,EAAUW,MAAM,gDAbpB8C,WAcW,WACP1G,EAAO6G,WAAY,EACnB7G,EAAOiH,QAAU,MAKzBjH,EAAO8G,OAAS,SAASI,GACrBzK,QAAQC,IAAI,GACZgK,EAAOI,QACHjI,IAAK,0DACLxC,MACIuK,KAAMF,EAAOK,cAAcG,MAEhChG,KAAK,SAASlF,GACbmL,SAAS,WACLnH,EAAOoH,OAASpL,EAASK,QAE9B,SAASL,GACJA,EAASI,OAAS,IAAG4D,EAAOqH,SAAWrL,EAASI,OAAS,KAAOJ,EAASK,OAC9E,SAASiL,GACRtH,EAAOuH,SAAWC,SAAS,IAAQF,EAAIG,OAASH,EAAII,aAOhEhN,IAAIoE,WAAW,iBAAkB,SAAU,YAAa,aAAc,WAAY,KAAM,SAAU,UAAW,WAAY,YAAa,KAAM,SAASkB,EAAQiD,EAAW7C,EAAYuH,EAAUtH,EAAIqG,EAC9LxL,EAASiM,EAAUjE,EAAW3H,GAC9ByE,EAAO4H,sBACP5H,EAAO6H,SACP7H,EAAO8H,SACHC,UAAU,GAGd3H,EAAWa,cAAcC,KAAK,SAASC,GACnCnB,EAAOoB,WAAaD,EAAK9E,IAIzB,KAAK,GAFD2L,GAAShI,EAAOoB,WAAW4G,OAEtBC,EAAI,EAAOD,EAAJC,EAAYA,IACxB,GAAiC,WAA7BjI,EAAOoB,WAAW6G,GAAG3D,KAAmB,CACxCtE,EAAO4H,mBAAmBtM,KAAK0E,EAAOoB,WAAW6G,GACjD,UAKZjI,EAAOkI,eAAiB,WAEpBlI,EAAOmI,oBAAsBnI,EAAOmI,oBAGxCnI,EAAOoI,UAAY,SAAStE,GACxB,GAAIuE,GAAMrI,EAAO4H,mBAAmBU,QAAQxE,EACxCuE,GAAM,GAAIrI,EAAO4H,mBAAmBW,OAAOF,EAAK,GAC/CrI,EAAO4H,mBAAmBtM,KAAKwI,IAGxC9D,EAAOwI,WAAa,SAAS1E,GACzB,MAAqB,WAAjBA,EAASQ,MAAkD,IAA7BtE,EAAOoB,WAAW4G,QACzC,EAEAhI,EAAO4H,mBAAmBU,QAAQxE,GAAY,GAkB7D9D,GAAOyI,cAAgB,SAASR,GAE5BjI,EAAO6H,MAAMU,OAAON,EAAG,GAG3B,IAAIS,GAAe,SAASb,GACxB,GAAInF,GAAInH,EAAGoH,QACPgG,IAEJ3I,GAAO6H,MAAQA,CAEf,IAAIe,GAAW,SAAShC,GACpBA,EAAKA,KAAOA,EACZA,EAAKE,OAASJ,EAAOI,QACjBjI,IAAK3D,EAAU,UACfmB,MACIuK,KAAMA,KAIdA,EAAKE,OAAO5F,KAAK,SAASlF,GACtB4K,EAAKiC,UAAW,EAChBjC,EAAKQ,OAASpL,EAASK,KAEvBsM,EAASrN,KAAKU,EAASK,KAAKyM,UAExBjB,EAAMG,QAAUW,EAASX,QACzBtF,EAAEzD,QAAQ0J,IAEf,SAAS3M,GACR4K,EAAKmC,QAAS,EACVlB,EAAMG,QAAUW,EAASX,QACzBtF,EAAEzD,QAAQ0J,IAEf,SAASrB,GACRV,EAAKW,SAAWyB,KAAKC,IAAI,IAAKzB,SAAS,IACnCF,EAAIG,OAASH,EAAII,UAW7B,OAPIG,IAASA,EAAMG,QACfrN,QAAQuO,QAAQrB,EAAO,SAASjB,GAC5BgC,EAAShC,KAKVlE,EAAEM,QAIbhD,GAAOmJ,YAAc,SAAS3H,GAG1B4H,KAAOpJ,EAAOoJ,KACdC,UAAYrJ,EAAOqJ,UAEdD,OACDA,KAAO,KAGc,mBAAdC,WAEPA,UAAY,EACLA,UAAUC,cAAe,GAASD,aAAc,EAEvDA,UAAY,EAGZA,UAAY,CAGhB,IAAIE,GAAa,SAASC,GAEtBxJ,EAAO8H,QAAQC,UAAW,CAI1B,KAAK,GAFD5G,MACAsI,EAAQzJ,EAAO4H,mBAAmBI,OAC7BC,EAAI,EAAOwB,EAAJxB,EAAWA,IACvB9G,EAAK7F,KAAK0E,EAAO4H,mBAAmBK,GAAGyB,GAI3CrJ,GAAGsJ,UACCP,KAAMI,EAAEI,EACRP,UAAWG,EAAEK,EACbzI,WAAYD,EACZ2I,OAAQN,EAAEvB,IACX/G,KAAK,SAASuC,GACbzD,EAAO8H,QAAQC,UAAW,EAET,MAAbtE,EAAErH,QACF4D,EAAOtF,IAAIgJ,MAAMqG,QAAQtG,EAAEpH,MAI/B2D,EAAOgK,aAAaC,QAAU,GAC9BjK,EAAOoJ,KAAO,GACdpJ,EAAOS,eAAgB,EACvBT,EAAO6H,UACR,SAASpE,GACRzD,EAAO8H,QAAQC,UAAW,IAI9B/H,GAAO6H,MAAMG,OACbU,EAAa1I,EAAO6H,OAAO3G,KACvB,SAASgJ,GAELX,GACIK,EAAGR,KAAKe,OACRN,EAAGR,UACHpB,EAAGiC,MAIXd,KAAKe,OACLZ,GACIK,EAAGR,KAAKe,OACRN,EAAGR,UACHpB,OAGJhF,EAAUW,MAAM,iCAOhClJ,IAAIoE,WAAW,oBAAqB,SAAU,YAAa,SAASkB,EAAQ8E,GACxE9E,EAAOoK,KAAO,WACVtF,EAAUsF,QAEdpK,EAAOqK,OAAS,WACZvF,EAAUuF,UAEdrK,EAAOsK,OAAS,SAASA,GACrBxF,EAAUsF,KAAKE,OAIvB5P,IAAIoE,WAAW,6BAA8B,SAAU,YAAa,aAAc,qBAAsB,SAASkB,EAAQ8E,EAAW1E,EAAYwH,GAE5IxH,EAAWa,cAAcC,KAAK,SAASqJ,GACnCvK,EAAOoB,WAAamJ,EAAIlO,KACxBI,QAAQC,IAAIsD,EAAOwK,WAEvBxK,EAAOoK,KAAO,WACVtF,EAAUsF,QAEdpK,EAAOqK,OAAS,WACZvF,EAAUuF,UAEdrK,EAAOyK,WAAa,SAASf,GACzBjN,QAAQC,IAAIsD,EAAO4H,oBAEnB9C,EAAUsF,KAAKV;ACxevBhP,IAAIgQ,UAAU,eAAgB,WAE1B,OACIC,SAAU,IACVC,YAAY,EACZ1O,SAAS,EACT0C,YAAa,iCAIrBlE,IAAIgQ,UAAU,gBAAiB,WAC3B,OACIC,SAAU,IACVC,YAAY,EACZ1O,SAAS,EACT0C,YAAa,kCAIrBlE,IAAIgQ,UAAU,aAAc,WACxB,OACIC,SAAU,IACVC,YAAY,EACZ1O,SAAS,EACT0C,YAAa,8BAIrBlE,IAAIgQ,UAAU,cAAe,WACzB,OACIC,SAAU,IACVC,YAAY,EACZ1O,SAAS,EACT0C,YAAa,gCAIrBlE,IAAIgQ,UAAU,qBAAsB,WAChC,OACIC,SAAU,IACVC,YAAY,EACZ1O,SAAS,EACT0C,YAAa,yCAIrBlE,IAAIgQ,UAAU,gBAAiB,cAAe,SAASG,GACnD,OACIF,SAAU,IACVC,YAAY,EACZ1O,SAAS,EACT0C,YAAa,4BACbkM,OACIpH,MAAO,gBACPP,YAAa,eAEjBrE,YAAA,SAAY,SAASkB,GAGjB+K,KAAKC,YAAc,SAASC,GACxBJ,EAAYzB,KAAK6B,GAASC,SAAShK,KAAK,SAASuC,GAC7C,GAAIwE,GAAIjI,EAAO0D,MAAMyH,IAAI,SAASC,GAC1B,MAAOA,GAAE1B,KAEZpB,QAAQ2C,EAGbjL,GAAO0D,MAAM6E,OAAON,EAAG,MAM/BjI,EAAOqL,SAAU,QAM7B3Q,IAAIgQ,UAAU,eAAgB,cAAe,iBAAkB,OAAQ,YAAa,WAAY,SAAU,SAASG,EAAaS,EAAgB3P,EAAMsH,EAAWc,EAAUwH,GACvK,OACIZ,SAAU,IACVa,QAAS,iBACTV,OACI1B,KAAM,gBAEVxK,YAAa,2BACbiD,KAAM,SAASiJ,EAAOvF,EAASkG,EAAOC,GAClCZ,EAAMvK,KAAO5E,EAAK6E,YAClBsK,EAAMa,YACFvI,SAAS,EAGb,IAAIwI,IACAC,YAAa,cAAe,aAC5BC,iBAAkB,YAAa,aAC/BC,aAAc,YAAa,gBAC3BC,gBAAiB,YAAa,gBAGlC,IAAIlB,EAAM1B,KAAK6C,qBACPnB,EAAM1B,KAAK6C,oBAAoBjE,OAAS,EAAG,CAC3CkE,eAAiB,GACjBjE,EAAI,CACJ,IAAI9F,GACAgK,EAAiBrB,EAAM1B,KAAK6C,mBAGhC,IAFAG,EAAItB,EAAM1B,KAAK6C,oBAAoBjE,OAE1B,GAALoE,EACAC,IAAMF,EAAe,GAAGG,YACxBJ,gBAAkB,IACdN,EAAQS,KAAK,GACb,IAAMT,EAAQS,KAAK,OACpB,IAAS,GAALD,EAEP,IAAKjK,IAAUgK,GACXlE,IACAoE,IAAMF,EAAehK,GAAQmK,YAEzBrE,GAAKmE,EAAI,IACTF,gBAAkB,IAAMN,EAAQS,KAAK,IAGrCpE,GAAKmE,IACLF,gBAAkB,QAAUN,EAAQS,KAAK,GAAK,IAAMT,EAAQS,KAAK,QAGtE,IAAID,EAAI,EACX,IAAKjK,IAAUgK,GACXlE,IACAoE,IAAMF,EAAehK,GAAQmK,YACzBrE,GAAKmE,GAAKA,EAAI,GACdF,gBAAkB,IAAMN,EAAQS,KAAK,GAC9BpE,GAAKmE,EAAI,EAChBF,gBAAkB,KAAON,EAAQS,KAAK,GAC/BD,GAAKnE,IACZiE,gBAAkB,QAAUN,EAAQS,KAAK,GAAK,IAAMT,EAAQS,KAAK,GAK7EvB,GAAMoB,eAAiBA,eAK/B,GAAI7K,EACJyJ,GAAMxJ,SAAW,SAASC,EAAaC,GACnCH,EAAeG,EACfD,EAAYC,IAIhBsJ,EAAMyB,gBAAiB,EACvBzB,EAAM0B,eAAiB,WAEf1B,EAAMyB,kBAAmB,IACzBzB,EAAMa,WAAWvI,SAAU,EAC3ByH,EAAYzB,KAAK0B,EAAM1B,KAAKM,IAAI7G,QAAQ,YAAY3B,KAAK,SAASuC,GAE9DqH,EAAM1B,KAAKqD,SAAWhJ,EAAEpH,KACxByO,EAAMa,WAAWvI,SAAU,GAC5B,SAASK,GACRqH,EAAMa,WAAWvI,SAAU,KAGnC0H,EAAMyB,gBAAiB,GAG3BzB,EAAM4B,WAAa,SAASlL,GACxB,GAAImL,GAAgB,WAEZ7B,EAAM8B,YACN/B,EAAYzB,KAAK0B,EAAM1B,KAAKM,IAAIN,KAAK,YACjCyD,KAAM/B,EAAM8B,aACb1L,KAAK,SAASuC,GAIbqH,EAAM1B,KAAK0D,iBACXhC,EAAM1B,KAAKqD,SAAS1C,QAAQtG,EAAEpH,MAC9ByO,EAAM8B,WAAa,KAK3BjR,GAAK6E,YAAYwD,cACjB2I,IAEA1J,EAAU8J,YAAYvL,GAAIN,KAAK,WAC3ByL,KACD,WACCK,EAAI,wBAKhBlC,EAAMmC,cAAgB,SAASC,GAC3B,GAAIC,GAAU7B,EAAe6B,QAAQD,EACrCC,GAAQjC,SAAShK,KAAK,SAASuC,GAE3B,GAAIwE,GAAI6C,EAAM1B,KAAKqD,SAAStB,IAAI,SAASC,GACjC,MAAOA,GAAE1B,KAEZpB,QAAQ4E,EAGbpC,GAAM1B,KAAKqD,SAASlE,OAAON,EAAG,GAC9B6C,EAAM1B,KAAK0D,oBAOnBhC,EAAMsC,eAAiB,SAAS5L,GAE5B,GAAI6L,GAAa,WACTvC,EAAM1B,KAAKkE,WACXxC,EAAM1B,KAAKkE,WAAY,EACvBxC,EAAM1B,KAAKmE,kBACX1C,EAAYzB,KAAK0B,EAAM1B,KAAKM,IAAIrK,IAAI,aAAa6L,SAAShK,KAAK,SAASuC,GAEpEqH,EAAM1B,KAAKkE,UAAY7J,EAAEpH,KAAKD,OAC9B0O,EAAM1B,KAAKmE,gBAAkB9J,EAAEpH,KAAKoN,UAGxCqB,EAAM1B,KAAKkE,WAAY,EACvBxC,EAAM1B,KAAKmE,kBACX1C,EAAYzB,KAAK0B,EAAM1B,KAAKM,IAAIrK,IAAI,aAAa+J,OAAOlI,KAAK,SAASuC,GAElEqH,EAAM1B,KAAKkE,UAAY7J,EAAEpH,KAAKD,OAC9B0O,EAAM1B,KAAKmE,gBAAkB9J,EAAEpH,KAAKoN,SAI5C9N,GAAK6E,YAAYwD,cACjBqJ,IAEApK,EAAU8J,YAAYvL,GAAIN,KAAK,WAC3BmM,OAOZvC,EAAM0C,UAAY,SAAShM,GAEvB,GAAIiM,GAAQ,WACJ3C,EAAM1B,KAAKsE,aACX5C,EAAM1B,KAAKsE,aAAc,EACzB5C,EAAM1B,KAAKuE,aACX9C,EAAYzB,KAAK0B,EAAM1B,KAAKM,IAAIrK,IAAI,QAAQ6L,SAAShK,KAAK,SAASuC,GAE/DqH,EAAM1B,KAAKsE,YAAcjK,EAAEpH,KAAKD,OAChC0O,EAAM1B,KAAKuE,WAAalK,EAAEpH,KAAKoN,UAGnCqB,EAAM1B,KAAKsE,aAAc,EACzB5C,EAAM1B,KAAKuE,aACX9C,EAAYzB,KAAK0B,EAAM1B,KAAKM,IAAIrK,IAAI,QAAQ+J,OAAOlI,KAAK,SAASuC,GAE7DqH,EAAM1B,KAAKsE,YAAcjK,EAAEpH,KAAKD,OAChC0O,EAAM1B,KAAKuE,WAAalK,EAAEpH,KAAKoN,SAKvC9N,GAAK6E,YAAYwD,cACjByJ,IAEAxK,EAAU8J,YAAYvL,GAAIN,KAAK,WAC3BuM,OAMZ3C,EAAM8C,QAAU,SAASpM,GAErB,GAAIqM,GAAY,WAEZ/C,EAAM1B,KAAK0E,MAAO,EAClBhD,EAAM1B,KAAK2E,cACXlD,EAAYzB,KAAK0B,EAAM1B,KAAKM,IAAIrK,IAAI,SAAS+J,OAAOlI,KAAK,SAASuC,GAE9DqH,EAAM1B,KAAK0E,KAAOrK,EAAEpH,KAAKD,OACzB0O,EAAM1B,KAAK2E,YAActK,EAAEpH,KAAKoN,QAIpC9N,GAAK6E,YAAYwD,cACjB6J,IAEA5K,EAAU8J,YAAYvL,GAAIN,KAAK,WAC3B2M,OAMZ/C,EAAMkD,UAAY,WACdjK,EAASpD,IACLsN,OAAQ,OAERpM,KAAM0J,EACN2C,QAAS3C,EAAS,gCAClBjH,KAAM,UACN6J,QAAS,yBACTC,YAAatD,EAAM1B,KAAKyD,KAAO,uGAChC,SAAS7Q,OAGhB8O,EAAMuD,WAAa,WAEf3C,EAAgBV,YAAYF,EAAM1B,KAAKM,UAOvDhP,IAAIgQ,UAAU,UAAW,WAAY,SAASvD,GAC1C,OACIwD,SAAU,IACVG,OACI/I,KAAM,KAEV7F,SAAS,EACT2F,KAAM,SAASiJ,EAAOwD,EAAG7C,KAGzBzM,SAAU,uCAIlBtE,IAAIgQ,UAAU,mBAAoB,WAC9B,OACIC,SAAU,IACV/L,YAAa;ACpVrBlE,IAAI6T,OAAO,gBAAiB,WACxB,MAAO,UAASC,GAWZ,MAVAC,KAAMD,EACFA,IACIA,GAAO,KAAa,OAANA,EACdC,IAAMzF,KAAK0F,MAAMF,EAAM,KAAO,GAAK,IAC5BA,GAAO,QAAgB,UAANA,EACxBC,IAAMzF,KAAK0F,MAAMF,EAAM,KAAU,GAAK,IAC/BA,GAAO,YACdC,IAAMzF,KAAK0F,MAAMF,EAAM,KAAa,GAAK,MAG1CC;ACZf/T,IAAIiU,QAAQ,cAAe,cAAe,OAAQ,KAAM,SAASvP,EAAazD,EAAM0E,GAEhF,GAAI3F,IACAgJ,SAGJ/H,GAAKiT,iBAAiB1N,KAAK,SAASuC,KAMpC,IAAIb,GAASxD,EAAYyP,QAAQ,UAE7BrL,EAAWpE,EAAYmH,IAAI,SAE3BtF,EAAgB7B,EAAYmH,IAAI,cAAc1D,SAGlD,QACInI,IAAKA,EACLkI,OAAQA,EACRY,SAAUA,EACVvC,cAAeA,MAKvBvG,IAAIiU,QAAQ,QAAS,QAAS,gBAAiB,cAAe,KAAM,SAAU,WAAY,SAASG,EAAOrT,EAAe2D,EAAa7D,EAAI4E,EAAQ4D,GAgB9I,QAASgL,GAAgBC,GACrB,GAAIC,GAASD,EAAI9S,QAAQ,IAAK,KAAKA,QAAQ,IAAK,IAChD,QAAQ+S,EAAOjH,OAAS,GACpB,IAAK,GACD,KACJ,KAAK,GACDiH,GAAU,IACV,MACJ,KAAK,GACDA,GAAU,GACV,MACJ,SACI,KAAM,4BAEd,MAAOC,QAAOC,KAAKF,GAGvB,QAASG,KACL,GAAItT,GAAQL,EAAcK,MACtBuT,IAGJ,IAAqB,mBAAVvT,GAAuB,CAC9B,GAAIwT,GAAUxT,EAAMyT,MAAM,KAAK,EAC/BF,GAASG,KAAKC,MAAMV,EAAgBO,IAGxC,MAAOD,GA1CX,GAAI9O,IACAyD,eAAe,EACf0F,GAAI,KACJpK,QAAS,KACTgF,KAAM,QACNoL,UAAW,QACXC,SAAU,QACVC,IAAK,KACLtP,SAAU,KACVuP,MAAO,KACP7I,OAAQ,gBAGZ5H,GAAY0Q,iBAAgB,EAgC5B,IAAIlB,GAAiB,WAIjB,GAAIlM,GAAInH,EAAGoH,OA2BX,OA1BIyM,KAAqB9P,SAAW8P,IAAqBW,IAAMC,KAAKC,MAAQ,IAMxE7Q,EAAYC,IAAI,QAAS+P,IAAqB9P,SAASC,MAAM2B,KAAK,SAASuC,GACvEyM,EAAiBzM,EAAEpH,MACnBqG,EAAEzD,SAAQ,IAEX,SAASwE,GACQ,KAAZA,EAAErH,SACFG,IAEAkF,KAEJiB,EAAEzD,SAAQ,KAOd1C,IAGGmG,EAAEM,SAGTkN,EAAmB,SAASC,GAE5B5P,EAAKyD,eAAgB,EACrBzD,EAAKmJ,GAAKyG,EAAEzG,GACZnJ,EAAKjB,QAAU6Q,EAAE7Q,QACjBiB,EAAK+D,KAAO6L,EAAEC,WAAa,IAAMD,EAAEE,UACnC9P,EAAKmP,UAAYS,EAAEC,WACnB7P,EAAKoP,SAAWQ,EAAEE,UAClB9P,EAAKqP,IAAMO,EAAEP,IACbrP,EAAKD,SAAW6P,EAAEzR,MAAQ,IAAMyR,EAAEG,QAClC/P,EAAKsP,MAAQM,EAAEN,MACftP,EAAKyG,OAASmJ,EAAEnJ,QAGhBuJ,EAAY,SAASzU,GAErBL,EAAcK,MAAQA,EACtByE,EAAKzE,MAAQA,GAGbkK,EAAS,SAAShB,GAClB,GAAItC,GAAInH,EAAGoH,OAaX,OAXAvD,GAAYyP,QAAQ,UAAUzF,KAAKpE,GAAS9D,KAAK,SAASuC,GAEtD8M,EAAU9M,EAAEpH,KAAKP,OACjB8S,IAEAzO,EAAOwB,GAAG,0BACVe,EAAEzD,QAAQwE,EAAEpH,KAAKP,QAClB,WACC4G,EAAE/F,WAGC+F,EAAEM,SAGT6B,EAAS,SAASuH,GAClB,GAAI1J,GAAInH,EAAGoH,OAaX,OAXAvD,GAAYyP,QAAQ,gBAAgBzF,KAAKgD,GAAGlL,KAAK,SAASuC,GAEtD8M,EAAU9M,EAAEpH,KAAKP,OACjB8S,IAEAzO,EAAOwB,GAAG,0BACVe,EAAEzD,QAAQwE,EAAEpH,KAAKP,QAClB,WACC4G,EAAE/F,WAGC+F,EAAEM,SAGTwB,EAAW,WAEX,GAAI9B,GAAInH,EAAGoH,QAEP6N,EAAY,SAASC,GACrB,GAAI/N,GAAInH,EAAGoH,OAiBX,OAhBAc,GAAIgN,EACa,cAAbhN,EAAErH,QACFsU,MACIC,gBAAmBlN,EAAEmN,aAAaC,aAEtCzR,EAAYyP,QAAQ,YAAYzF,KAAKsH,MAAMxP,KAAK,SAASuC,GACrD8M,EAAU9M,EAAEpH,KAAKP,OACjB8S,IAEAlM,EAAEzD,QAAQwE,IACX,SAASA,GACRf,EAAE/F,OAAO8G,MAGbf,EAAE/F,SAEC+F,EAAEM,QAYb,OATAe,GAASmB,MAAM,SAASzB,GAEpB+M,EAAU/M,GAAGvC,KAAK,WACdwB,EAAEzD,WACH,SAASwE,GACRf,EAAE/F,OAAO8G,OAIVf,EAAEM,SAGTvB,EAAS,WACTqP,qBACOrV,GAAcK,MACrB8S,IACAzO,EAAOwB,GAAG,kBAGVpF,EAAe,WACfgE,EAAKyD,eAAgB,EACrBzD,EAAKmJ,GAAK,KACVnJ,EAAKjB,QAAU,KACfiB,EAAK+D,KAAO,QACZ/D,EAAKmP,UAAY,QACjBnP,EAAKoP,SAAW,QAChBpP,EAAKqP,IAAM,KACXrP,EAAKD,SAAW,KAChBC,EAAKsP,MAAQ,KACbtP,EAAKyG,OAAS,gBAGlB,QACIhB,OAAQA,EACRnB,OAAQA,EACRL,SAAUA,EACV/C,OAAQA,EACRmN,eAAgBA,EAChBrS,aAAcA,EACdiE,YAAaD,EACbzE,MAAOsT,QAIf1U,IAAIiU,QAAQ,MAAO,OAAQ,cAAe,KAAM,SAAShT,EAAMyD,EAAa7D,GAExE,GAAIwV,GAAMpV,EAAKG,MAAMkV,IAGjBC,EAAK7R,EAAYC,IAAI,QAAS0R,GAE9BpH,EAAW,SAASH,GACpB,MAAOpK,GAAYmH,IAAI,SAAS6C,MAC5BA,KAAQI,EAAEJ,KACVC,UAAaG,EAAEH,UACfjI,WAAcoI,EAAEpI,WAChB0I,OAAUN,EAAEM,SAIpB,QACIJ,GAAIqH,EACJE,GAAIA,EACJjN,cAAerI,EAAK6E,YAAYwD,cAChCmC,UAAW8K,EAAG1K,IAAI,aAClBrH,QAASvD,EAAK6E,YACdmJ,SAAUA,MAKlBjP,IAAIiU,QAAQ,eAAgB,cAAe,KAAM,SAASvP,EAAa7D,GAEnE,GAEI6N,IAFQhK,EAAYmH,IAAI,SAEjB,SAASmD,GAChB,MAAOtK,GAAYC,IAAI,QAASqK,IAGpC,QACIN,KAAMA,MAKd1O,IAAIiU,QAAQ,kBAAmB,cAAe,KAAM,SAASvP,EAAa7D,GAEtE,GAEI4R,IAFQ/N,EAAYmH,IAAI,YAEd,SAASmD,GACnB,MAAOtK,GAAYC,IAAI,WAAYqK,IAGvC,QACIyD,QAASA,MAKjBzS,IAAIiU,QAAQ,iBAAkB,WAAY,OAAQ,SAAS5K,EAAUpI,GAGjE,YAKJjB,IAAIiU,QAAQ,aAAc,YAAa,WAAY,OAAQ,KAAM,YAAa,SAAS7J,EAAW6C,EAAUhM,EAAMJ,EAAI2H,GAElH,GAAI6J,GAAc,SAASvL,GACvB,GAAIkB,GAAInH,EAAGoH,OAcX,OAbAmC,GAAUM,MACFtG,WAAY,mBACZF,YAAa,gCACb0G,OAAQE,SAAS0L,uBAAuB,iBACxCC,YAAa3P,EACbkE,qBAAqB,IAExBxE,KAAK,SAASqJ,GACX7H,EAAEzD,QAAQsL,IACX,WACC7H,EAAE/F,WAGH+F,EAAEM,SAGTqC,EAAQ,SAAS7D,EAAIqL,GAIrB/H,EAAUM,KACNN,EAAUO,QACTC,OAAO3K,QAAQ4K,QAAQC,SAASC,cAAc,UAC9CC,qBAAoB,GACpB5D,MAAM+K,GAENlH,UAAUkH,GACVjH,GAAG,MACHuL,YAAY3P,KAIjBoC,EAAQ,SAASiJ,GACjBlF,EAASvC,KACLuC,EAASyJ,SACRC,QAAQxE,GACRyE,SAAS,YACThM,OAAOpC,EAAU,GAAGuC,cAAc,SAClC8L,UAAU,OAKf9M,EAAY,WACZ9I,EAAK6I,WAAWtD,KAAK,WACjB4D,EAAUsF,MAAK,IAChB,WACC1H,EAAI,gBAIRgC,EAAgB,SAASC,GACzBhJ,EAAKkJ,OAAOF,GAAczD,KAAK,SAASuC,GACpCqB,EAAUsF,MAAK,IAChB,SAASzG,GACRlH,QAAQC,IAAIiH,KAOpB,QAEIoJ,YAAaA,EACb1H,MAAOA,EACPzB,MAAOA,EACPa,UAAWA,EACXC,cAAeA","file":"app.js","sourcesContent":["//\"use strict\";\r\n\r\nvar app = angular.module('testify', ['ngMaterial',\r\n    'chieffancypants.loadingBar',\r\n    'ngAnimate',\r\n    'ngMessages',\r\n    'angularMoment',\r\n    'ui.router',\r\n    'ngStorage',\r\n    'restangular',\r\n    'facebook',\r\n    'ngFileUpload',\r\n    'ngImgCrop',\r\n    'ngTextTruncate',\r\n    'emojiApp'\r\n]);\r\n\r\n//app.constant('apiBase', \"http://localhost/testify/api\");\r\napp.constant('appUrl', \"https://testify-for-testimonies.herokuapp.com\");\r\napp.constant('appBase', \"/\");\r\napp.constant('apiBase', \"http://localhost:8000/api/v1\");\r\n//app.constant('apiBase', \"https://testify-for-testimonies.herokuapp.com/api\");\r\n\r\napp.config(function(FacebookProvider, $httpProvider, RestangularProvider, apiBase) {\r\n    FacebookProvider.setAppId(180042792329807);\r\n    RestangularProvider.setBaseUrl(apiBase);\r\n\r\n    $httpProvider.interceptors.push(['$q', '$location', '$localStorage', function($q, $location, $localStorage, $rootScope, Auth) {\r\n        return {\r\n            'request': function(config) {\r\n                config.headers = config.headers || {};\r\n                if ($localStorage.token) {\r\n                    config.headers.Authorization = 'Bearer ' + $localStorage.token;\r\n                }\r\n                return config;\r\n            },\r\n            'response': function(response) {\r\n                var t = response.headers('Authorization');\r\n                if (t) {\r\n                    t.replace('Bearer ', '');\r\n                    $localStorage.token = t;\r\n                    //console.log(t);\r\n                }\r\n\r\n                return response;\r\n            },\r\n            'responseError': function(response) {\r\n                if (response.status === 401 || response.status === 400 || response.status === 403) {\r\n                    if (response.data.error == 'token_expired') {\r\n                        delete $localStorage.token;\r\n                        Auth.resetProfile();\r\n                        $location.path('/signin');\r\n                    } else if (response.data.error == 'token_invalid') {\r\n                        delete $localStorage.token;\r\n                        Auth.resetProfile();\r\n                        $location.path('/signin');\r\n                    } else if (response.data.error == 'Bad Authorization') {\r\n                        delete $localStorage.token;\r\n                        Auth.resetProfile();\r\n                        $location.path('/signin');\r\n                    } else if (response.data.error == 'token_not_provided') {\r\n                        delete $localStorage.token;\r\n                        Auth.resetProfile();\r\n                        $location.path('/signin');\r\n                    }\r\n\r\n\r\n\r\n                    console.log(\"Unauthorized or forbidden\");\r\n\r\n                }\r\n                return $q.reject(response);\r\n            }\r\n        };\r\n    }]);\r\n});\r\n\r\napp.run(function() {\r\n    // Cut and paste the \"Load the SDK\" code from the facebook javascript sdk page.\r\n\r\n    // Load the facebook SDK asynchronously\r\n    /*(function(d, s, id) {\r\n        var js, fjs = d.getElementsByTagName(s)[0];\r\n        if (d.getElementById(id)) {\r\n            return;\r\n        }\r\n        js = d.createElement(s);\r\n        js.id = id;\r\n        js.src = \"//connect.facebook.net/en_US/sdk.js\";\r\n        fjs.parentNode.insertBefore(js, fjs);\r\n    }(document, 'script', 'facebook-jssdk'));*/\r\n});\r\n\r\napp.config(function($mdThemingProvider) {\r\n    var myPaletteMap = $mdThemingProvider.extendPalette('blue', {\r\n\r\n        'contrastDefaultColor': 'light',\r\n        'contrastDarkColors': '200, 300',\r\n        'contrastLightColors': '500',\r\n        '500': '97B6CA',\r\n        '50': '1C3456',\r\n        '100': '5DADE0',\r\n        '200': 'e74c3c',\r\n        '300': 'FFFFFF',\r\n        '400': 'F4F4F4',\r\n        '600': '27ae60',\r\n        '700': '77777E'\r\n    });\r\n    $mdThemingProvider.definePalette('palette', myPaletteMap);\r\n    //console.log(myPaletteMap);\r\n    $mdThemingProvider.theme('default')\r\n        .primaryPalette('palette', {\r\n            'default': '500',\r\n            'hue-1': '50',\r\n            'hue-2': '100',\r\n            'hue-3': '300',\r\n        })\r\n        .accentPalette('palette', {\r\n            'default': '200',\r\n            'hue-1': '600',\r\n            'hue-2': '700'\r\n\r\n        })\r\n        .warnPalette('red', {\r\n\r\n        });\r\n\r\n    $mdThemingProvider.theme('input', 'default')\r\n        .primaryPalette('grey', {\r\n\r\n        })\r\n        .backgroundPalette('palette', {\r\n            'default': '500'\r\n        }).dark();\r\n\r\n    $mdThemingProvider.theme('search', 'default')\r\n        .primaryPalette('yellow', {\r\n\r\n        })\r\n        .backgroundPalette('palette', {\r\n            'default': '50'\r\n        }).dark();\r\n\r\n    ///$mdIconProvider.defaultFontSet(\"mdi\", \"mdi-\");\r\n});\r\n\r\napp.config(function($stateProvider, $urlRouterProvider, $locationProvider, appBase) {\r\n    $stateProvider\r\n        .state('web', {\r\n            //url: appBase,\r\n            abstract: true,\r\n            templateUrl: 'views/web.html'\r\n        }).state('web.app', {\r\n            abstract: true,\r\n            url: appBase,\r\n            templateUrl: 'views/web.app.html'\r\n        }).state('web.app.login', {\r\n            url: 'login',\r\n            templateUrl: 'views/web.app.login.html',\r\n        }).state('web.app.signup', {\r\n            url: 'signup',\r\n            controller: 'LoginCtrl',\r\n            templateUrl: 'views/web.app.signup.html',\r\n            data: {\r\n                showSideNav: false\r\n            }\r\n        }).state('web.app.logout', {\r\n            url: 'logout',\r\n\r\n            controller: 'LogoutCtrl',\r\n            template: \" \",\r\n            data: {\r\n                showSideNav: false\r\n            }\r\n        }).state('web.app.landing', {\r\n            url: '',\r\n            templateUrl: 'views/web.app.landing.html',\r\n        }).state('web.app.dashboard', {\r\n            abstract: true,\r\n            url: '',\r\n            templateUrl: 'views/web.app.dashboard.html',\r\n        }).state('web.app.dashboard.home', {\r\n            url: 'home',\r\n            templateUrl: 'views/web.app.dashboard.home.html'\r\n        }).state('web.app.dashboard.post', {\r\n            url: 'post/:hash_id',\r\n            templateUrl: 'views/web.app.dashboard.post.html'\r\n        }).state('web.app.dashboard.posts', {\r\n            url: 'posts?cat',\r\n            templateUrl: 'views/web.app.dashboard.home.html'\r\n        }).state('web.app.dashboard.user', {\r\n            url: 'user/:hash_id',\r\n            resolve: {\r\n                profile: function($stateParams, Restangular) {\r\n                    return Restangular.one('users', $stateParams.hash_id).get();\r\n                }\r\n            },\r\n            views: {\r\n                '': {\r\n                    templateUrl: \"views/web.app.dashboard.profile.html\",\r\n                    controller: 'ProfileCtrl',\r\n                },\r\n                '@web.app.dashboard.user': {\r\n                    templateUrl: 'views/web.app.dashboard.profile.activities.html',\r\n                }\r\n            }\r\n        }).state('web.app.dashboard.user.activities', {\r\n            url: '/activities',\r\n            templateUrl: 'views/web.app.dashboard.profile.activities.html',\r\n        }).state('web.app.dashboard.user.favorites', {\r\n            url: '/favorites',\r\n            templateUrl: 'views/web.app.dashboard.profile.favorites.html',\r\n        }).state('web.app.dashboard.user.taps', {\r\n            url: '/taps',\r\n            templateUrl: 'views/web.app.dashboard.profile.taps.html',\r\n        }).state('web.app.dashboard.user.edit', {\r\n            url: '/edit',\r\n            views: {\r\n                '@web.app.dashboard': {\r\n                    templateUrl: 'views/web.app.dashboard.profile.edit.html'\r\n\r\n                }\r\n            }\r\n        });\r\n\r\n    $urlRouterProvider.otherwise(appBase + \"home\");\r\n\r\n    $locationProvider.html5Mode({\r\n        enabled: true,\r\n        requireBase: false\r\n    });\r\n});\r\n","app.controller('AppCtrl', function($rootScope, $scope, $mdSidenav, $mdMedia, $location, $state, $q, AppService, Auth, Me, appBase) {\r\n    $scope.location = $location;\r\n    $scope.user = Auth.userProfile;\r\n    $scope.composingPost = false;\r\n    $scope.tokHashId = Auth.token.hash_id;\r\n    //$state.go('web.app.login');\r\n\r\n    $scope.ui = {\r\n        showSearch: false,\r\n        showSideNav: $state,\r\n        toggleNav: function(which) {\r\n            $mdSidenav(which).toggle();\r\n            //console.log(which);\r\n        },\r\n        toggleSearchBox: function() {\r\n            $scope.ui.showSearch = !$scope.ui.showSearch;\r\n        }\r\n    };\r\n    //console.log($state);\r\n    //$scope.ui.showSideNav = $state.current.data.showSideNav;\r\n    //console.log($scope.tokHashId);\r\n\r\n    AppService.getCategories.then(function(cats) {\r\n\r\n        $scope.categories = cats.data;\r\n    });\r\n\r\n\r\n    var originatorEv;\r\n    $scope.openMenu = function($mdOpenMenu, ev) {\r\n        originatorEv = ev;\r\n        $mdOpenMenu(ev);\r\n        //console.log(ev)\r\n    };\r\n\r\n    $scope.logout = function() {\r\n        Auth.logout();\r\n        //Me.callInit();\r\n        //console.log($scope.user);\r\n    };\r\n\r\n    $scope.redirect = function(state) {\r\n        $state.go(state);\r\n    };\r\n\r\n    $scope.menu = [{\r\n        link: '',\r\n        state: 'web.app.dashboard.home',\r\n        title: 'Feeds',\r\n        icon: 'home',\r\n        condition: true,\r\n        click: ''\r\n    }];\r\n\r\n    $scope.menuAuth = [{\r\n        link: 'profile',\r\n        state: \"web.app.dashboard.user({hash_id: tokHashId})\",\r\n        title: 'Profile',\r\n        icon: 'account',\r\n        condition: 'user.authenticated',\r\n        action: null\r\n    }, {\r\n        link: '',\r\n        state: 'web.app.dashboard.home',\r\n        title: 'Messages',\r\n        icon: 'message-text-outline',\r\n        condition: 'user.authenticated',\r\n        click: ''\r\n    }, {\r\n        link: 'showListBottomSheet($event)',\r\n        state: 'web.app.dashboard.user.favorites({hash_id: tokHashId})',\r\n        title: 'Favourites',\r\n        icon: 'star',\r\n        condition: 'user.authenticated',\r\n        action: null\r\n    }, {\r\n        link: 'showListBottomSheet($event)',\r\n        state: 'web.app.dashboard.settings',\r\n        title: 'Settings',\r\n        icon: 'settings',\r\n        condition: 'user.authenticated',\r\n        action: null\r\n    }];\r\n\r\n\r\n\r\n\r\n\r\n    $scope.getSearchResultIcon = function(type) {\r\n        //console.log(icon[type]);\r\n        return icon[type];\r\n    };\r\n\r\n    $scope.searchIcons = {\r\n        \"tag\": \"pound\",\r\n        \"user\": \"at\"\r\n    };\r\n\r\n\r\n\r\n    $scope.searchRepo = function(query) {\r\n        var d = $q.defer();\r\n        AppService.search.getList({\r\n            q: query\r\n        }).then(function(response) {\r\n            d.resolve(response.data.plain());\r\n            //console.log(response.data.plain());\r\n            //return result;\r\n        }, function() {\r\n            d.reject();\r\n        });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n});\r\n","app.controller('PostsCtrl', ['AppService', 'Me', '$scope', '$state', '$stateParams', 'Restangular', 'UXService', '$document', function(AppService, Me, $scope, $state, $stateParams, Restangular, UXService, $document) {\r\n    $scope.app = AppService.app; //Post.getList();\r\n    $scope.post_status = {\r\n        loading: false\r\n    };\r\n    var loadPosts = function() {\r\n        var param = null;\r\n        $scope.post_status.loading = true;\r\n\r\n        if ($stateParams.cat) {\r\n            load({\r\n                category: $stateParams.cat\r\n            });\r\n        } else {\r\n            load({});\r\n        }\r\n\r\n\r\n        function load(param) {\r\n\r\n            AppService.getPosts.getList(param).then(function(r) {\r\n                //console.log(AppService.app);\r\n                AppService.app.posts = r.data;\r\n                /*l = r.data.length;\r\n                for (i = 0; i < l; i++) {\r\n                    AppService.app.posts.unshift(r.data[i]);\r\n                }*/\r\n\r\n                $scope.post_status.loading = false;\r\n                //console.log(r.data.plain());\r\n            }, function(err) {\r\n                $scope.post_status.loading = false;\r\n                //console.log(err);\r\n                UXService.toast(\"Something's wrong\");\r\n            });\r\n        }\r\n    };\r\n\r\n    loadPosts();\r\n\r\n\r\n\r\n}]);\r\n\r\napp.controller('LoginCtrl', ['$scope', 'UXService', 'Facebook', '$q', '$state', 'Auth', 'Me', 'appBase', function($scope, UXService, Facebook, $q, $state, Auth, Me, appBase) {\r\n\r\n    if (Auth.userProfile.authenticated === true) {\r\n        $state.go('web.app.dashboard.home');\r\n    }\r\n\r\n    $scope.fb_button = \"Login with Facebook\";\r\n\r\n    Facebook.getLoginStatus(function(r) {\r\n        //console.log(r);\r\n        if (r.status === 'connected') {\r\n            //console.log(r);\r\n            Facebook.api('/me', function(r) {\r\n                $scope.fb_logged_in = true;\r\n                $scope.fb_name = r.name;\r\n                $scope.fb_button = \"Continue as \" + $scope.fb_name;\r\n            });\r\n            //console.log(r);\r\n        } else {\r\n            //console.log(\"false;\");                \r\n            $scope.fb_logged_in = false;\r\n            $scope.fb_name = \"null\";\r\n            $scope.fb_button = \"Login with Facebook\";\r\n        }\r\n    });\r\n\r\n    $scope.loginFB = function() {\r\n        Auth.signinFB().then(function() {\r\n            $state.go('web.app.dashboard.home');\r\n        }, function(r) {\r\n            UXService.toast(r.data.error);\r\n        });\r\n    };\r\n\r\n    $scope.UXLoginFB = function() {\r\n        UXService.UXLoginFB();\r\n    };\r\n\r\n    $scope.UXSubmitLogin = function() {\r\n        UXService.UXSubmitLogin($scope.loginDetails);\r\n    };\r\n\r\n    var refresh = function() {\r\n        Facebook.api(\"/me\", {\r\n            fields: 'id,name,email,access_token'\r\n        }).then(\r\n            function(response) {\r\n                $scope.welcomeMsg = \"Welcome \" + response.name;\r\n                console.log(response);\r\n                //console.log(JSON.stringify(response));\r\n            },\r\n            function(err) {\r\n                $scope.welcomeMsg = \"Please log in\";\r\n            });\r\n    };\r\n\r\n    $scope.submitLogin = function() {\r\n        Auth.signin($scope.loginDetails).then(function(r) {\r\n            //console.log($scope.user);\r\n            $state.go('web.app.dashboard.home');\r\n            //Me.callInit();\r\n            //Success Login\r\n        }, function(err) {\r\n            console.log(err);\r\n            //console.log($scope.loginDetails);\r\n        });\r\n    };\r\n\r\n}]);\r\n\r\napp.controller('SignupCtrl', ['$scope', 'Facebook', 'Auth', '$location', '$mdDialog', '$state', function($scope, Facebook, Auth, $location, $mdDialog, $state) {\r\n    var refresh;\r\n\r\n    $scope.newUser = {};\r\n    $scope.signupFb = function() {\r\n        Facebook.login().then(function() {\r\n            refresh();\r\n        });\r\n    };\r\n\r\n    refresh = function() {\r\n        Facebook.api(\"/me\", {\r\n            fields: 'id,first_name,last_name,email'\r\n        }).then(\r\n            function(response) {\r\n                Facebook.logout();\r\n                //$scope.welcomeMsg = \"Welcome \" + response.name;\r\n                //console.log(response);\r\n                //console.log(JSON.stringify(response));\r\n                //Auth.BuildSession(name, id, lastname for appctrl scope);\r\n                //$location.path('/');\r\n            },\r\n            function(err) {\r\n                $mdDialog.show(\r\n                    $mdDialog.alert()\r\n                    .parent(angular.element(document.querySelector('body')))\r\n                    .clickOutsideToClose(true)\r\n                    .title('Login failed!')\r\n                    //.content('Login failed')\r\n                    .ariaLabel('Failed login')\r\n                    .ok('close')\r\n                    //.targetEvent(ev)\r\n                );\r\n\r\n                //$scope.welcomeMsg = \"Please log in\";\r\n            });\r\n    };\r\n\r\n    $scope.submitForm = function() {\r\n        //console.log($scope.newUser);\r\n        //console.log($scope.signupForm.$valid);\r\n        if ($scope.signupForm.$valid) {\r\n            Auth.signup($scope.newUser).then(\r\n                function(r) {\r\n\r\n                    $state.go('web.app.dashboard.home');\r\n                    //console.log(r);\r\n                },\r\n                function(r) {\r\n                    //console.log(r);\r\n                });\r\n        }\r\n    };\r\n\r\n}]);\r\n\r\napp.controller('LogoutCtrl', ['$scope', 'Auth', 'Me', function($scope, Auth, Me) {\r\n    Auth.logout();\r\n    //$scope.logout();\r\n    console.log(\"mayama\");\r\n}]);\r\n\r\napp.controller('ProfileCtrl', ['Restangular', '$scope', '$stateParams', '$state', function(Restangular, $scope, $stateParams, $state) {\r\n    //console.log(profile);\r\n    var user_profile = Restangular.one('users', $stateParams.hash_id);\r\n\r\n    $scope.user = {\r\n        profile: {},\r\n        activities: [],\r\n        favorites: [],\r\n        taps: []\r\n    };\r\n\r\n\r\n    var loadUserProfile = function() {\r\n        user_profile.one('profile').get().then(function(r) {\r\n            $scope.user.profile = r.data;\r\n        });\r\n    };\r\n\r\n    var loadUserPosts = function() {\r\n        user_profile.all('activities').getList().then(function(r) {\r\n            $scope.user.activities = r.data;\r\n        });\r\n    };\r\n\r\n    var loadUserFavorites = function() {\r\n        user_profile.all('favorites').getList().then(function(r) {\r\n            $scope.user.favorites = r.data;\r\n        });\r\n    };\r\n\r\n    var loadUserTaps = function() {\r\n        user_profile.all('taps').getList().then(function(r) {\r\n            $scope.user.taps = r.data;\r\n        });\r\n    };\r\n\r\n    loadUserProfile();\r\n    loadUserPosts();\r\n    loadUserFavorites();\r\n    loadUserTaps();\r\n\r\n\r\n}]);\r\n\r\napp.controller('ProfileEditCtrl', ['Restangular', '$scope', '$stateParams', '$state', 'Upload', 'Auth', 'UXService', 'apiBase', function(Restangular, $scope, $stateParams, $state, Upload, Auth, UXService, apiBase) {\r\n    //console.log(profile);\r\n    var user_profile = Restangular.one('users', $stateParams.hash_id);\r\n\r\n    $scope.user = Auth.userProfile;\r\n\r\n    if (Auth.userProfile.hash_id !== $stateParams.hash_id) {\r\n\r\n        $state.go('web.app.dashboard.home');\r\n    }\r\n\r\n\r\n    $scope.uploadAvatar = function(file) {\r\n        $scope.uploading = true;\r\n\r\n        Upload.upload({\r\n            url: apiBase + '/users/' + Auth.userProfile.hash_id + '/profile/avatar',\r\n            data: {\r\n                file: Upload.dataUrltoBlob(file)\r\n            }\r\n\r\n\r\n        }).then(function(r) {\r\n            Auth.userProfile.avatar = r.data.url;\r\n            UXService.toast('Successfully updated your display picture');\r\n\r\n        }, function() {\r\n            //console.log(file);\r\n            UXService.toast('Changing display picture wasn\\'t successful');\r\n        }).finally(function() {\r\n            $scope.uploading = false;\r\n            $scope.picFile = '';\r\n        });\r\n    };\r\n\r\n\r\n    $scope.upload = function(dataUrl) {\r\n        console.log(9);\r\n        Upload.upload({\r\n            url: 'https://angular-file-upload-cors-srv.appspot.com/upload',\r\n            data: {\r\n                file: Upload.dataUrltoBlob(dataUrl)\r\n            },\r\n        }).then(function(response) {\r\n            $timeout(function() {\r\n                $scope.result = response.data;\r\n            });\r\n        }, function(response) {\r\n            if (response.status > 0) $scope.errorMsg = response.status + ': ' + response.data;\r\n        }, function(evt) {\r\n            $scope.progress = parseInt(100.0 * evt.loaded / evt.total);\r\n        });\r\n    };\r\n\r\n\r\n}]);\r\n\r\napp.controller('TComposerCtrl', ['$scope', 'UXService', 'AppService', '$mdToast', 'Me', 'Upload', 'apiBase', '$timeout', '$document', '$q', function($scope, UXService, AppService, $mdToast, Me, Upload,\r\n    apiBase, $timeout, $document, $q) {\r\n    $scope.selectedCategories = [];\r\n    $scope.files = [];\r\n    $scope.newPost = {\r\n        creating: false\r\n    };\r\n\r\n    AppService.getCategories.then(function(cats) {\r\n        $scope.categories = cats.data;\r\n\r\n        var length = $scope.categories.length;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if ($scope.categories[i].name == 'General') {\r\n                $scope.selectedCategories.push($scope.categories[i]);\r\n                break;\r\n            }\r\n        }\r\n    });\r\n\r\n    $scope.toggleCatPopup = function() {\r\n\r\n        $scope.showSelectCatPopup = !$scope.showSelectCatPopup;\r\n    };\r\n\r\n    $scope.catsClick = function(category) {\r\n        var idx = $scope.selectedCategories.indexOf(category);\r\n        if (idx > -1) $scope.selectedCategories.splice(idx, 1);\r\n        else $scope.selectedCategories.push(category);\r\n    };\r\n\r\n    $scope.catsExists = function(category) {\r\n        if (category.name == 'General' && $scope.categories.length === 0) {\r\n            return true;\r\n        } else {\r\n            return $scope.selectedCategories.indexOf(category) > -1;\r\n\r\n        }\r\n    };\r\n\r\n\r\n    var isUploadFinished = function() {\r\n        finished = true;\r\n\r\n        angular.forEach($scope.files, function(file, key) {\r\n            if (file.complete !== true) {\r\n                finished = false;\r\n            }\r\n\r\n        });\r\n        return finished;\r\n    };\r\n\r\n    $scope.removePicture = function(i) {\r\n\r\n        $scope.files.splice(i, 1);\r\n    };\r\n\r\n    var uploadImages = function(files) {\r\n        var d = $q.defer();\r\n        var finished = [];\r\n\r\n        $scope.files = files;\r\n\r\n        var doUpload = function(file) {\r\n            file.file = file;\r\n            file.upload = Upload.upload({\r\n                url: apiBase + '/images',\r\n                data: {\r\n                    file: file\r\n                }\r\n            });\r\n\r\n            file.upload.then(function(response) {\r\n                file.complete = true;\r\n                file.result = response.data;\r\n                //console.log(response);\r\n                finished.push(response.data.image_id);\r\n\r\n                if (files.length == finished.length) {\r\n                    d.resolve(finished);\r\n                }\r\n            }, function(response) {\r\n                file.failed = true;\r\n                if (files.length == finished.length) {\r\n                    d.resolve(finished);\r\n                }\r\n            }, function(evt) {\r\n                file.progress = Math.min(100, parseInt(100.0 *\r\n                    evt.loaded / evt.total));\r\n            });\r\n        };\r\n\r\n        if (files && files.length) {\r\n            angular.forEach(files, function(file) {\r\n                doUpload(file);\r\n            });\r\n\r\n\r\n        }\r\n        return d.promise;\r\n\r\n    };\r\n\r\n    $scope.composePost = function(ev) {\r\n        //post = \"\";\r\n        //console.log($scope);\r\n        post = $scope.post;\r\n        anonymous = $scope.anonymous;\r\n\r\n        if (!post) {\r\n            post = \" \";\r\n        }\r\n\r\n        if (typeof anonymous === \"undefined\") {\r\n\r\n            anonymous = 0;\r\n        } else if (anonymous.$viewValue === false || anonymous === false) {\r\n\r\n            anonymous = 0;\r\n        } else {\r\n\r\n            anonymous = 1;\r\n        }\r\n\r\n        var createPost = function(o) {\r\n            //console.log(Me.sendPost);\r\n            $scope.newPost.creating = true;\r\n\r\n            var cats = [];\r\n            var count = $scope.selectedCategories.length;\r\n            for (var i = 0; i < count; i++) {\r\n                cats.push($scope.selectedCategories[i].id);\r\n            }\r\n\r\n\r\n            Me.sendPost({\r\n                post: o.p,\r\n                anonymous: o.a,\r\n                categories: cats,\r\n                images: o.i\r\n            }).then(function(r) {\r\n                $scope.newPost.creating = false;\r\n\r\n                if (r.status === 201) {\r\n                    $scope.app.posts.unshift(r.data);\r\n                    //console.log(r.data);\r\n                }\r\n\r\n                $scope.emojiMessage.rawhtml = \"\";\r\n                $scope.post = \"\";\r\n                $scope.composingPost = false;\r\n                $scope.files = [];\r\n            }, function(r) {\r\n                $scope.newPost.creating = false;\r\n            });\r\n        };\r\n\r\n        if ($scope.files.length) {\r\n            uploadImages($scope.files).then(\r\n                function(id_arr) {\r\n                    //console.log(id_arr);\r\n                    createPost({\r\n                        p: post.trim(),\r\n                        a: anonymous,\r\n                        i: id_arr\r\n                    });\r\n                });\r\n        } else {\r\n            if (post.trim()) {\r\n                createPost({\r\n                    p: post.trim(),\r\n                    a: anonymous,\r\n                    i: []\r\n                });\r\n            } else {\r\n                UXService.toast(\"Your post has no content!\");\r\n            }\r\n\r\n        }\r\n    };\r\n}]);\r\n\r\napp.controller('UXModalLoginCtrl', ['$scope', '$mdDialog', function($scope, $mdDialog) {\r\n    $scope.hide = function() {\r\n        $mdDialog.hide();\r\n    };\r\n    $scope.cancel = function() {\r\n        $mdDialog.cancel();\r\n    };\r\n    $scope.answer = function(answer) {\r\n        $mdDialog.hide(answer);\r\n    };\r\n}]);\r\n\r\napp.controller('UXModalPostCategorizeCtrl', ['$scope', '$mdDialog', 'AppService', 'selectedCategories', function($scope, $mdDialog, AppService, selectedCategories) {\r\n\r\n    AppService.getCategories.then(function(res) {\r\n        $scope.categories = res.data;\r\n        console.log($scope.actives);\r\n    });\r\n    $scope.hide = function() {\r\n        $mdDialog.hide();\r\n    };\r\n    $scope.cancel = function() {\r\n        $mdDialog.cancel();\r\n    };\r\n    $scope.filePostIn = function(id) {\r\n        console.log($scope.selectedCategories);\r\n\r\n        $mdDialog.hide(id);\r\n    };\r\n}]);\r\n","app.directive('leftSidenav', [function() {\r\n\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/left-sidenav.html'\r\n    };\r\n}]);\r\n\r\napp.directive('rightSidenav', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/right-sidenav.html'\r\n    };\r\n}]);\r\n\r\napp.directive('searchbox', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/searchbox.html'\r\n    };\r\n}]);\r\n\r\napp.directive('appToolbar', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/app-toolbar.html'\r\n    };\r\n}]);\r\n\r\napp.directive('appToolbarNoLogin', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'partials/app-toolbar-no-login.html'\r\n    };\r\n}]);\r\n\r\napp.directive('testifyPosts', ['PostService', function(PostService) {\r\n    return {\r\n        restrict: 'A',\r\n        transclude: true,\r\n        replace: true,\r\n        templateUrl: 'templates/Post/posts.html',\r\n        scope: {\r\n            posts: '=testifyPosts',\r\n            post_status: '=postStatus'\r\n        },\r\n        controller: function($scope) {\r\n            //console.log($scope.posts);\r\n\r\n            this.SDeletePost = function(post_id) {\r\n                PostService.post(post_id).remove().then(function(r) {\r\n                    var i = $scope.posts.map(function(x) {\r\n                            return x.id;\r\n                        })\r\n                        .indexOf(post_id);\r\n                    //console.log($scope);\r\n                    //array.splice(removeIndex, 1);\r\n                    $scope.posts.splice(i, 1);\r\n                    //scope.post = \"\";\r\n                });\r\n\r\n            };\r\n\r\n            $scope.noPosts = false;\r\n\r\n        }\r\n    };\r\n}]);\r\n\r\napp.directive('testifyPost', ['PostService', 'CommentService', 'Auth', 'UXService', 'Facebook', 'appUrl', function(PostService, CommentService, Auth, UXService, Facebook, appUrl) {\r\n    return {\r\n        restrict: 'A',\r\n        require: \"^?testifyPosts\",\r\n        scope: {\r\n            post: '=testifyPost'\r\n        },\r\n        templateUrl: 'templates/Post/post.html',\r\n        link: function(scope, element, attrs, SuperTPostsCtrl) {\r\n            scope.user = Auth.userProfile;\r\n            scope.CommentsUI = {\r\n                loading: false\r\n            };\r\n\r\n            var actions = {\r\n                'App\\\\Tap': ['tapped into', 'this post'],\r\n                'App\\\\Favorite': ['favorited', 'this post'],\r\n                'App\\\\Amen': ['said amen', 'to this post'],\r\n                'App\\\\Comment': ['commented', 'on this post']\r\n            };\r\n\r\n            if (scope.post.user_ref_activities) {\r\n                if (scope.post.user_ref_activities.length > 0) {\r\n                    interpretation = '';\r\n                    i = 0;\r\n                    var action;\r\n                    var ref_activities = scope.post.user_ref_activities;\r\n                    l = scope.post.user_ref_activities.length;\r\n\r\n                    if (l == 1) {\r\n                        a_t = ref_activities[0].action_type;\r\n                        interpretation += ' ' +\r\n                            actions[a_t][0] +\r\n                            ' ' + actions[a_t][1];\r\n                    } else if (l == 2) {\r\n\r\n                        for (action in ref_activities) {\r\n                            i++;\r\n                            a_t = ref_activities[action].action_type;\r\n\r\n                            if (i == l - 1) {\r\n                                interpretation += ' ' + actions[a_t][0];\r\n                            }\r\n\r\n                            if (i == l) {\r\n                                interpretation += ' and ' + actions[a_t][0] + ' ' + actions[a_t][1];\r\n                            }\r\n                        }\r\n                    } else if (l > 2) {\r\n                        for (action in ref_activities) {\r\n                            i++;\r\n                            a_t = ref_activities[action].action_type;\r\n                            if (i == l - (l - 1)) {\r\n                                interpretation += ' ' + actions[a_t][0];\r\n                            } else if (i <= l - 1) {\r\n                                interpretation += ', ' + actions[a_t][0];\r\n                            } else if (l >= i) {\r\n                                interpretation += ' and ' + actions[a_t][0] + ' ' + actions[a_t][1];\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    scope.interpretation = interpretation;\r\n                }\r\n\r\n            }\r\n\r\n            var originatorEv;\r\n            scope.openMenu = function($mdOpenMenu, ev) {\r\n                originatorEv = ev;\r\n                $mdOpenMenu(ev);\r\n                //console.log(ev)\r\n            };\r\n\r\n            scope.showCommentBox = false;\r\n            scope.openCommentBox = function() {\r\n                //console.log(scope.post.post_id);\r\n                if (scope.showCommentBox === false) {\r\n                    scope.CommentsUI.loading = true;\r\n                    PostService.post(scope.post.id).getList('comments').then(function(r) {\r\n                        //console.log(r);\r\n                        scope.post.comments = r.data;\r\n                        scope.CommentsUI.loading = false;\r\n                    }, function(r) {\r\n                        scope.CommentsUI.loading = false;\r\n                    });\r\n                }\r\n                scope.showCommentBox = true;\r\n            };\r\n\r\n            scope.addComment = function(ev) {\r\n                var doCommentPost = function() {\r\n                    //console.log(Date());\r\n                    if (scope.commentBox) {\r\n                        PostService.post(scope.post.id).post('comments', {\r\n                            text: scope.commentBox\r\n                        }).then(function(r) {\r\n                            //console.log(r);\r\n\r\n                            //console.log(comment.text);\r\n                            scope.post.comments_count++;\r\n                            scope.post.comments.unshift(r.data);\r\n                            scope.commentBox = \"\";\r\n\r\n                        });\r\n                    }\r\n                };\r\n                if (Auth.userProfile.authenticated) {\r\n                    doCommentPost();\r\n                } else {\r\n                    UXService.signinModal(ev).then(function() {\r\n                        doCommentPost();\r\n                    }, function() {\r\n                        v = \"Unsuccessful login\";\r\n                    });\r\n                }\r\n            };\r\n\r\n            scope.deleteComment = function(comment_id) {\r\n                var comment = CommentService.comment(comment_id);\r\n                comment.remove().then(function(r) {\r\n                    //console.log(r);\r\n                    var i = scope.post.comments.map(function(x) {\r\n                            return x.id;\r\n                        })\r\n                        .indexOf(comment_id);\r\n                    //console.log($scope);\r\n                    //array.splice(removeIndex, 1);\r\n                    scope.post.comments.splice(i, 1);\r\n                    scope.post.comments_count--;\r\n\r\n                    //scope.post = \"\";\r\n\r\n                });\r\n            };\r\n\r\n            scope.toggleFavorite = function(ev) {\r\n                //console.log(scope.post.post_id)\r\n                var doFavorite = function() {\r\n                    if (scope.post.favorited) {\r\n                        scope.post.favorited = false;\r\n                        scope.post.favorites_count--;\r\n                        PostService.post(scope.post.id).one('favorites').remove().then(function(r) {\r\n                            //console.log(r);\r\n                            scope.post.favorited = r.data.status;\r\n                            scope.post.favorites_count = r.data.count;\r\n                        });\r\n                    } else {\r\n                        scope.post.favorited = true;\r\n                        scope.post.favorites_count++;\r\n                        PostService.post(scope.post.id).one('favorites').post().then(function(r) {\r\n                            //console.log(\"created\");\r\n                            scope.post.favorited = r.data.status;\r\n                            scope.post.favorites_count = r.data.count;\r\n                        });\r\n                    }\r\n                };\r\n                if (Auth.userProfile.authenticated) {\r\n                    doFavorite();\r\n                } else {\r\n                    UXService.signinModal(ev).then(function() {\r\n                        doFavorite();\r\n                    });\r\n\r\n                }\r\n                //console.log(scope.post);\r\n            };\r\n\r\n            scope.toggleTap = function(ev) {\r\n                //console.log(scope.post.post_id)\r\n                var doTap = function() {\r\n                    if (scope.post.tapped_into) {\r\n                        scope.post.tapped_into = false;\r\n                        scope.post.taps_count--;\r\n                        PostService.post(scope.post.id).one('taps').remove().then(function(r) {\r\n                            //console.log(r);\r\n                            scope.post.tapped_into = r.data.status;\r\n                            scope.post.taps_count = r.data.count;\r\n                        });\r\n                    } else {\r\n                        scope.post.tapped_into = true;\r\n                        scope.post.taps_count++;\r\n                        PostService.post(scope.post.id).one('taps').post().then(function(r) {\r\n                            //console.log(\"created\");\r\n                            scope.post.tapped_into = r.data.status;\r\n                            scope.post.taps_count = r.data.count;\r\n                        });\r\n                    }\r\n                };\r\n\r\n                if (Auth.userProfile.authenticated) {\r\n                    doTap();\r\n                } else {\r\n                    UXService.signinModal(ev).then(function() {\r\n                        doTap();\r\n                    });\r\n                }\r\n                //console.log(scope.post);\r\n            };\r\n\r\n            scope.sayAmen = function(ev) {\r\n                //console.log(scope.post.post_id)\r\n                var doSayAmen = function() {\r\n\r\n                    scope.post.amen = true;\r\n                    scope.post.amens_count++;\r\n                    PostService.post(scope.post.id).one('amens').post().then(function(r) {\r\n                        //console.log(\"created\");\r\n                        scope.post.amen = r.data.status;\r\n                        scope.post.amens_count = r.data.count;\r\n                    });\r\n\r\n                };\r\n                if (Auth.userProfile.authenticated) {\r\n                    doSayAmen();\r\n                } else {\r\n                    UXService.signinModal(ev).then(function() {\r\n                        doSayAmen();\r\n                    });\r\n\r\n                }\r\n            };\r\n\r\n            scope.shareToFb = function() {\r\n                Facebook.ui({\r\n                    method: 'feed',\r\n                    //link: 'https://testify-for-testimonies.herokuapp.com/api/fb-share/56',\r\n                    link: appUrl,\r\n                    picture: appUrl + '/img/testify-fb-share-pic.png',\r\n                    name: 'Testify',\r\n                    caption: 'Sharing God\\'s goodness',\r\n                    description: scope.post.text + ' (Tesfify is a community for sharing your testimonies and engaging with other people\\'s testimonies)'\r\n                }, function(response) {});\r\n            };\r\n\r\n            scope.deletePost = function() {\r\n                //scope.post = null;\r\n                SuperTPostsCtrl.SDeletePost(scope.post.id);\r\n\r\n            };\r\n        }\r\n    };\r\n}]);\r\n\r\napp.directive('myIcon', ['$timeout', function($timeout) {\r\n    return {\r\n        restrict: 'E',\r\n        scope: {\r\n            icon: \"@\"\r\n        },\r\n        replace: true,\r\n        link: function(scope, e, attrs) {\r\n            //scope.icon = scope.icon;\r\n        },\r\n        template: \"<i class='mdi mdi-{{icon}}'></i>\"\r\n    };\r\n}]);\r\n\r\napp.directive('testifyComposer', [function() {\r\n    return {\r\n        restrict: 'A',\r\n        templateUrl: 'partials/testifyComposer.html',\r\n        //controller: 'TComposerCtrl'\r\n    };\r\n}]);\r\n","app.filter('socialCounter', function() {\r\n    return function(num) {\r\n        out = num;\r\n        if (num) {\r\n            if (num >= 999 && num < 999999) {\r\n                out = Math.round(num / 100) / 10 + \"K\";\r\n            } else if (num >= 999999 && num < 999999999) {\r\n                out = Math.round(num / 100000) / 10 + \"M\";\r\n            } else if (num >= 999999999) {\r\n                out = Math.round(num / 100000000) / 10 + \"B\";\r\n            }\r\n        }\r\n        return out;\r\n    };\r\n});\r\n","app.factory('AppService', ['Restangular', 'Auth', 'Me', function(Restangular, Auth, Me) {\r\n\r\n    var app = {\r\n        posts: []\r\n    };\r\n\r\n    Auth.refreshProfile().then(function(r) {\r\n        //Me.callInit();\r\n        //console.log(\"letsee\");\r\n    });\r\n    //console.log(\"appService\");\r\n\r\n    var search = Restangular.service('search');\r\n\r\n    var getPosts = Restangular.all('posts');\r\n\r\n    var getCategories = Restangular.all('categories').getList();\r\n\r\n\r\n    return {\r\n        app: app,\r\n        search: search,\r\n        getPosts: getPosts,\r\n        getCategories: getCategories\r\n\r\n    };\r\n}]);\r\n\r\napp.factory('Auth', ['$http', '$localStorage', 'Restangular', '$q', '$state', 'Facebook', function($http, $localStorage, Restangular, $q, $state, Facebook) {\r\n    var user = {\r\n        authenticated: false,\r\n        id: null,\r\n        hash_id: null,\r\n        name: \"Guest\",\r\n        firstName: \"Guest\",\r\n        lastName: \"Guest\",\r\n        sex: null,\r\n        location: null,\r\n        email: null,\r\n        avatar: \"img/guest.png\",\r\n    };\r\n\r\n    Restangular.setFullResponse(true);\r\n\r\n    function urlBase64Decode(str) {\r\n        var output = str.replace('-', '+').replace('_', '/');\r\n        switch (output.length % 4) {\r\n            case 0:\r\n                break;\r\n            case 2:\r\n                output += '==';\r\n                break;\r\n            case 3:\r\n                output += '=';\r\n                break;\r\n            default:\r\n                throw 'Illegal base64url string!';\r\n        }\r\n        return window.atob(output);\r\n    }\r\n\r\n    function getClaimsFromToken() {\r\n        var token = $localStorage.token;\r\n        var claims = {};\r\n\r\n        //console.log(token);\r\n        if (typeof token !== 'undefined') {\r\n            var encoded = token.split('.')[1];\r\n            claims = JSON.parse(urlBase64Decode(encoded));\r\n        }\r\n\r\n        return claims;\r\n    }\r\n\r\n    var refreshProfile = function() {\r\n        //console.log(\"refresh\")\r\n        //console.log(getClaimsFromToken());\r\n\r\n        var d = $q.defer();\r\n        if (getClaimsFromToken().hash_id && getClaimsFromToken().exp > Date.now() / 1000) {\r\n            //console.log(\"truthy\");\r\n            //console.log(getClaimsFromToken().hash_id);\r\n            //console.log(Date.now() / 1000);\r\n            //console.log(getClaimsFromToken().exp);\r\n\r\n            Restangular.one('users', getClaimsFromToken().hash_id).get().then(function(r) {\r\n                buildAuthProfile(r.data);\r\n                d.resolve(true);\r\n                //console.log(getClaimsFromToken().id);\r\n            }, function(r) {\r\n                if (r.status == 404) {\r\n                    resetProfile();\r\n                    //console.log(\"user not found\");\r\n                    logout();\r\n                }\r\n                d.resolve(false);\r\n\r\n            });\r\n        } else {\r\n            //console.log(Date.now() / 1000);\r\n            //console.log(getClaimsFromToken().exp);\r\n            //delete $localStorage.token;\r\n            resetProfile();\r\n        }\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var buildAuthProfile = function(u) {\r\n        //console.log(u);\r\n        user.authenticated = true;\r\n        user.id = u.id;\r\n        user.hash_id = u.hash_id;\r\n        user.name = u.first_name + ' ' + u.last_name;\r\n        user.firstName = u.first_name;\r\n        user.lastName = u.last_name;\r\n        user.sex = u.sex;\r\n        user.location = u.state + ' ' + u.country;\r\n        user.email = u.email;\r\n        user.avatar = u.avatar;\r\n    };\r\n\r\n    var saveToken = function(token) {\r\n\r\n        $localStorage.token = token;\r\n        user.token = token;\r\n    };\r\n\r\n    var signup = function(newUser) {\r\n        var d = $q.defer();\r\n\r\n        Restangular.service('signup').post(newUser).then(function(r) {\r\n            //console.log(r);\r\n            saveToken(r.data.token);\r\n            refreshProfile(); //Refresh session data here\r\n            //$scope.refreshProfile();\r\n            $state.go('web.app.dashboard.home');\r\n            d.resolve(r.data.token);\r\n        }, function() {\r\n            d.reject();\r\n        });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var signin = function(l) {\r\n        var d = $q.defer();\r\n\r\n        Restangular.service('authenticate').post(l).then(function(r) {\r\n            //console.log(r);\r\n            saveToken(r.data.token);\r\n            refreshProfile(); //Refresh session data here\r\n            //$scope.refreshProfile();\r\n            $state.go('web.app.dashboard.home');\r\n            d.resolve(r.data.token);\r\n        }, function() {\r\n            d.reject();\r\n        });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var signinFB = function() {\r\n        //console.log(\"loginctrl\");\r\n        var d = $q.defer();\r\n\r\n        var doFbLogin = function(fb_response) {\r\n            var d = $q.defer();\r\n            r = fb_response;\r\n            if (r.status === 'connected') {\r\n                json = {\r\n                    \"fb_access_token\": r.authResponse.accessToken\r\n                };\r\n                Restangular.service('fb-token').post(json).then(function(r) {\r\n                    saveToken(r.data.token);\r\n                    refreshProfile(); //Refresh session data here\r\n                    //console.log(r);\r\n                    d.resolve(r);\r\n                }, function(r) {\r\n                    d.reject(r);\r\n                });\r\n            } else {\r\n                d.reject();\r\n            }\r\n            return d.promise;\r\n        };\r\n\r\n        Facebook.login(function(r) {\r\n            //console.log(r);\r\n            doFbLogin(r).then(function() {\r\n                d.resolve();\r\n            }, function(r) {\r\n                d.reject(r);\r\n            });\r\n        });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var logout = function() {\r\n        tokenClaims = {};\r\n        delete $localStorage.token;\r\n        refreshProfile();\r\n        $state.go('web.app.login');\r\n    };\r\n\r\n    var resetProfile = function() {\r\n        user.authenticated = false;\r\n        user.id = null;\r\n        user.hash_id = null;\r\n        user.name = \"Guest\";\r\n        user.firstName = \"Guest\";\r\n        user.lastName = \"Guest\";\r\n        user.sex = null;\r\n        user.location = null;\r\n        user.email = null;\r\n        user.avatar = \"img/guest.png\";\r\n    };\r\n\r\n    return {\r\n        signup: signup,\r\n        signin: signin,\r\n        signinFB: signinFB,\r\n        logout: logout,\r\n        refreshProfile: refreshProfile,\r\n        resetProfile: resetProfile,\r\n        userProfile: user,\r\n        token: getClaimsFromToken()\r\n    };\r\n}]);\r\n\r\napp.factory('Me', ['Auth', 'Restangular', '$q', function(Auth, Restangular, $q) {\r\n\r\n    var uid = Auth.token.sub;\r\n    //console.log(uid);\r\n\r\n    var me = Restangular.one('users', uid);\r\n\r\n    var sendPost = function(o) {\r\n        return Restangular.all('posts').post({\r\n            \"post\": o.post,\r\n            \"anonymous\": o.anonymous,\r\n            \"categories\": o.categories,\r\n            \"images\": o.images\r\n        });\r\n    };\r\n\r\n    return {\r\n        id: uid,\r\n        me: me,\r\n        authenticated: Auth.userProfile.authenticated,\r\n        favorites: me.all('favorites'),\r\n        profile: Auth.userProfile,\r\n        sendPost: sendPost\r\n\r\n    };\r\n}]);\r\n\r\napp.factory('PostService', ['Restangular', '$q', function(Restangular, $q) {\r\n\r\n    var posts = Restangular.all('posts');\r\n\r\n    var post = function(id) {\r\n        return Restangular.one('posts', id);\r\n    };\r\n\r\n    return {\r\n        post: post\r\n    };\r\n\r\n}]);\r\n\r\napp.factory('CommentService', ['Restangular', '$q', function(Restangular, $q) {\r\n\r\n    var posts = Restangular.all('comments');\r\n\r\n    var comment = function(id) {\r\n        return Restangular.one('comments', id);\r\n    };\r\n\r\n    return {\r\n        comment: comment\r\n    };\r\n\r\n}]);\r\n\r\napp.factory('SocialService', ['Facebook', 'Auth', function(Facebook, Auth) {\r\n\r\n\r\n    return {\r\n\r\n    };\r\n}]);\r\n\r\napp.factory('UXService', ['$mdDialog', '$mdToast', 'Auth', '$q', '$document', function($mdDialog, $mdToast, Auth, $q, $document) {\r\n\r\n    var signinModal = function(ev) {\r\n        var d = $q.defer();\r\n        $mdDialog.show({\r\n                controller: 'UXModalLoginCtrl',\r\n                templateUrl: 'partials/ux.signin.modal.html',\r\n                parent: document.getElementsByClassName(\"dialog-holder\"),\r\n                targetEvent: ev,\r\n                clickOutsideToClose: true\r\n            })\r\n            .then(function(res) {\r\n                d.resolve(res);\r\n            }, function() {\r\n                d.reject();\r\n            });\r\n\r\n        return d.promise;\r\n    };\r\n\r\n    var alert = function(ev, text) {\r\n        // Appending dialog to document.body to cover sidenav in docs app\r\n        // Modal dialogs should fully cover application\r\n        // to prevent interaction outside of dialog\r\n        $mdDialog.show(\r\n            $mdDialog.alert()\r\n            .parent(angular.element(document.querySelector('body')))\r\n            .clickOutsideToClose(true)\r\n            .title(text)\r\n            //.content(text)\r\n            .ariaLabel(text)\r\n            .ok('OK')\r\n            .targetEvent(ev)\r\n        );\r\n    };\r\n\r\n    var toast = function(text) {\r\n        $mdToast.show(\r\n            $mdToast.simple()\r\n            .content(text)\r\n            .position('top left')\r\n            .parent($document[0].querySelector('body'))\r\n            .hideDelay(7000)\r\n        );\r\n\r\n    };\r\n\r\n    var UXLoginFB = function() {\r\n        Auth.signinFB().then(function() {\r\n            $mdDialog.hide(true);\r\n        }, function() {\r\n            d = \"Do nothing\";\r\n        });\r\n    };\r\n\r\n    var UXSubmitLogin = function(loginDetails) {\r\n        Auth.signin(loginDetails).then(function(r) {\r\n            $mdDialog.hide(true);\r\n        }, function(err) {\r\n            console.log(err);\r\n            //console.log($scope.loginDetails);\r\n        });\r\n    };\r\n\r\n\r\n\r\n    return {\r\n\r\n        signinModal: signinModal,\r\n        alert: alert,\r\n        toast: toast,\r\n        UXLoginFB: UXLoginFB,\r\n        UXSubmitLogin: UXSubmitLogin\r\n\r\n    };\r\n}]);\r\n"],"sourceRoot":"/source/"}